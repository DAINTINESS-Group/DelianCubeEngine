DATASOURCE TYPE: RDBMS WITH INI FILE: InputFiles/tpc_ds_cube_10m/dbc.ini;

CREATE DIMENSION customer_dim
LIST OF LEVELS {
	CREATE LEVEL customer WITH ATTRIBUTES{
		c_customer_sk: Number DATASOURCE c_customer_sk,
		c_customer_id: Text DATASOURCE c_customer_id,
		c_current_cdemo_sk: Number DATASOURCE c_current_cdemo_sk,                    
		c_current_hdemo_sk: Number DATASOURCE c_current_hdemo_sk,
		c_current_addr_sk: Number DATASOURCE c_current_addr_sk,
		c_first_shipto_date_sk: Number DATASOURCE c_first_shipto_date_sk,
		c_first_sales_date_sk: Number DATASOURCE c_first_sales_date_sk,
		c_salutation: Text DATASOURCE c_salutation,
		c_first_name: Text DATASOURCE c_first_name,
		c_last_name: Text DATASOURCE c_last_name,
		c_preferred_cust_flag: Text DATASOURCE c_preferred_cust_flag,
		c_birth_day: Number DATASOURCE c_birth_day,
		c_birth_month: Number DATASOURCE c_birth_month,
		c_birth_country: Text DATASOURCE c_birth_country,
		c_login: Text DATASOURCE c_login,
		c_email_address: Text DATASOURCE c_email_address,
		c_last_review_date: Text DATASOURCE c_last_review_date
	} WITH ID: customer_sk AND DESCRIPTION: c_last_name,
	CREATE LEVEL birth_month WITH ATTRIBUTES{
		c_birth_month_and_year: Text DATASOURCE c_birth_month_and_year
	} WITH ID: c_birth_month_and_year AND DESCRIPTION: c_birth_month_and_year,
	CREATE LEVEL birth_year WITH ATTRIBUTES{
		c_birth_year: Number DATASOURCE c_birth_year
	} WITH ID: c_birth_year AND DESCRIPTION: c_birth_year,
	CREATE LEVEL All_customer WITH ATTRIBUTES{
		All: Text DATASOURCE All
	} WITH ID: All AND DESCRIPTION: All	
}
HIERARCHY customer>birth_month>birth_year>All_customer
DATASOURCE customer;

CREATE DIMENSION customer_address_dim
LIST OF LEVELS {
	CREATE LEVEL customer_address WITH ATTRIBUTES{
		ca_address_sk: Number DATASOURCE ca_address_sk,
		ca_address_id: Text DATASOURCE ca_address_id,
		ca_street_number: Text DATASOURCE ca_street_number,
		ca_street_name: Text DATASOURCE ca_street_name,
		ca_street_type: Text DATASOURCE ca_street_type,
		ca_suite_number: Text DATASOURCE ca_suite_number,
		ca_city: Text DATASOURCE ca_city,
		ca_county: Text DATASOURCE ca_county,
		ca_zip: Text DATASOURCE ca_zip,
		ca_gmt_offset: Number DATASOURCE ca_gmt_offset,
		ca_location_type: Text DATASOURCE ca_location_type
	} WITH ID: ca_address_sk AND DESCRIPTION: ca_address_sk,
	CREATE LEVEL customer_state WITH ATTRIBUTES{
		ca_state: Text DATASOURCE ca_state
	} WITH ID: ca_state AND DESCRIPTION: ca_state,
	CREATE LEVEL customer_country WITH ATTRIBUTES{
		ca_country: Text DATASOURCE ca_country
	} WITH ID: ca_country AND DESCRIPTION: ca_country,
	CREATE LEVEL All_customer_address WITH ATTRIBUTES{
		All: Text DATASOURCE All
	} WITH ID: All AND DESCRIPTION: All	
}
HIERARCHY customer_address>customer_state>customer_country>All_customer_address
DATASOURCE customer_address;

CREATE DIMENSION date_dim
LIST OF LEVELS {
	CREATE LEVEL date WITH ATTRIBUTES{
		d_date_sk: Number DATASOURCE d_date_sk,
		d_date_id: Number DATASOURCE d_date_id,
		d_date: Date DATASOURCE d_date,
		d_month_seq: Number DATASOURCE d_month_seq,
		d_week_seq: Number DATASOURCE d_week_seq,
		d_quarter_seq: Number DATASOURCE d_quarter_seq,
		d_year: Number DATASOURCE d_year,
		d_dow: Number DATASOURCE d_dow,
		d_moy: Number DATASOURCE d_moy,
		d_dom: Number DATASOURCE d_dom,
		d_qoy: Number DATASOURCE d_qoy,
		d_fy_year: Number DATASOURCE d_fy_year,
		d_fy_quarter_seq: Number DATASOURCE d_fy_quarter_seq,
		d_fy_week_seq: Number DATASOURCE d_fy_week_seq,
		d_day_name: Text DATASOURCE d_day_name,
		d_quarter_name: Text DATASOURCE d_quarter_name,
		d_holiday: Text DATASOURCE d_holiday,
		d_weekend: Text DATASOURCE d_weekend,
		d_following_holiday: Text DATASOURCE d_following_holiday,
		d_first_dom: Number DATASOURCE d_first_dom,
		d_last_dom: Number DATASOURCE d_last_dom,
		d_same_day_ly: Number DATASOURCE d_same_day_ly,
		d_same_day_lq: Number DATASOURCE d_same_day_lq,
		d_current_day: Text DATASOURCE d_current_day,
		d_current_week: Text DATASOURCE d_current_week,
		d_current_month: Text DATASOURCE d_current_month,
		d_current_quarter: Text DATASOURCE d_current_quarter,
		d_current_year: Text DATASOURCE d_current_year
	} WITH ID: d_date_sk AND DESCRIPTION: d_date,
	CREATE LEVEL month WITH ATTRIBUTES{
		d_month_and_year: Text DATASOURCE d_month_and_year
	} WITH ID: d_month_and_year AND DESCRIPTION: d_month_and_year,
	CREATE LEVEL quarter WITH ATTRIBUTES{
		d_quarter_name: Text DATASOURCE d_quarter_name
	} WITH ID: d_quarter_name AND DESCRIPTION: d_quarter_name,
	CREATE LEVEL year WITH ATTRIBUTES{
		d_year: Text DATASOURCE d_year
	} WITH ID: d_year AND DESCRIPTION: d_year,
	CREATE LEVEL All_date_dim WITH ATTRIBUTES{
		All: Text DATASOURCE All
	} WITH ID: All AND DESCRIPTION: All	
}
HIERARCHY date>month>quarter>year>All_date_dim
DIMENSION_TYPE date
DATASOURCE date_dim;

CREATE DIMENSION time_dim
LIST OF LEVELS {
	CREATE LEVEL time WITH ATTRIBUTES{
		t_time_sk: Number DATASOURCE t_time_sk,
		t_time_id: Text DATASOURCE t_time_id,
		t_time: Number DATASOURCE t_time,
		t_minute: Number DATASOURCE t_minute,
		t_second: Number DATASOURCE t_second,
		t_am_pm: Text DATASOURCE t_am_pm,
		t_shift: Text DATASOURCE t_shift,
		t_meal_time: Text DATASOURCE t_meal_time
	} WITH ID: t_time_sk AND DESCRIPTION: t_time,
	CREATE LEVEL hour WITH ATTRIBUTES{
		t_hour: Number DATASOURCE t_hour
	} WITH ID: t_hour AND DESCRIPTION: t_hour,
	CREATE LEVEL time_of_day WITH ATTRIBUTES{
		t_sub_shift: Text DATASOURCE t_sub_shift
	} WITH ID: t_sub_shift AND DESCRIPTION: t_sub_shift,
	CREATE LEVEL All_time_dim WITH ATTRIBUTES{
		All: Text DATASOURCE All
	} WITH ID: All AND DESCRIPTION: All	
}
HIERARCHY time>hour>time_of_day>All_time_dim
DATASOURCE time_dim;

CREATE DIMENSION store_dim
LIST OF LEVELS {
	CREATE LEVEL store WITH ATTRIBUTES{
		s_store_sk: Number DATASOURCE s_store_sk,
		s_store_id: Text DATASOURCE s_store_id,
		s_rec_start_date: Date DATASOURCE s_rec_start_date,
		s_rec_end_date: Date DATASOURCE s_rec_end_date,
		s_closed_date_sk: Number DATASOURCE s_closed_date_sk,
		s_store_name: Text DATASOURCE s_store_name,
		s_number_employees: Number DATASOURCE s_number_employees,
		s_floor_space: Number DATASOURCE s_floor_space,
		s_hours: Text DATASOURCE s_hours,
		s_manager: Text DATASOURCE s_manager,
		s_market_id: Number DATASOURCE s_market_id,
		s_geography_class: Text DATASOURCE s_geography_class,
		s_market_desc: Text DATASOURCE s_market_desc,
		s_market_manager: Text DATASOURCE s_market_manager,
		s_division_id: Number DATASOURCE s_division_id,
		s_division_name: Text DATASOURCE s_division_name,
		s_company_id: Number DATASOURCE s_company_id,
		s_company_name: Text DATASOURCE s_company_name,
		s_street_number: Text DATASOURCE s_street_number,
		s_street_name: Text DATASOURCE s_street_name,
		s_street_type: Text DATASOURCE s_street_type,
		s_suite_number: Text DATASOURCE s_suite_number,
		s_zip: Text DATASOURCE s_zip,
		s_gmt_offset: Number DATASOURCE s_gmt_offset,
		s_tax_precentage: Number DATASOURCE s_tax_precentage
	} WITH ID: s_store_sk AND DESCRIPTION: s_store_name,
	CREATE LEVEL store_city WITH ATTRIBUTES{
		s_city: Text DATASOURCE s_city
	} WITH ID: s_city AND DESCRIPTION: s_city,
	CREATE LEVEL store_county WITH ATTRIBUTES{
		s_county: Text DATASOURCE s_county
	} WITH ID: s_county AND DESCRIPTION: s_county,
	CREATE LEVEL store_state WITH ATTRIBUTES{
		s_state: Text DATASOURCE s_state
	} WITH ID: s_state AND DESCRIPTION: s_state,
	CREATE LEVEL store_country WITH ATTRIBUTES{
		s_country: Text DATASOURCE s_country
	} WITH ID: s_country AND DESCRIPTION: s_country,
	CREATE LEVEL All_store WITH ATTRIBUTES{
		All: Text DATASOURCE All
	} WITH ID: All AND DESCRIPTION: All	
}
HIERARCHY store>store_city>store_county>store_state>store_country>All_store
DATASOURCE store;

CREATE DIMENSION item_dim
LIST OF LEVELS {
	CREATE LEVEL item WITH ATTRIBUTES{
		i_item_sk: Number DATASOURCE i_item_sk,
		i_item_id: Text DATASOURCE i_item_id,
		i_rec_start_date: Date DATASOURCE i_rec_start_date,
		i_rec_end_date: Date DATASOURCE i_rec_end_date,
		i_item_desc: Text DATASOURCE i_item_desc,
		i_current_price: Number DATASOURCE i_current_price,
		i_wholesale_cost: Number DATASOURCE i_wholesale_cost,
		i_brand_id: Number DATASOURCE i_brand_id,
		i_brand: Text DATASOURCE i_brand,
		i_class_id: Number DATASOURCE i_class_id,
		i_class: Text DATASOURCE i_class,
		i_category_id: Number DATASOURCE i_category_id,
		i_manufact_id: Number DATASOURCE i_manufact_id,
		i_manufact: Text DATASOURCE i_manufact,
		i_size: Text DATASOURCE i_size,
		i_formulation: Text DATASOURCE i_formulation,
		i_color: Text DATASOURCE i_color,
		i_units: Text DATASOURCE i_units,
		i_container: Text DATASOURCE i_container,
		i_manager_id: Number DATASOURCE i_manager_id
	} WITH ID: i_item_sk AND DESCRIPTION: i_item_desc,
	CREATE LEVEL product_name WITH ATTRIBUTES{
		i_product_name: Text DATASOURCE i_product_name
	} WITH ID: i_product_name AND DESCRIPTION: i_product_name,
	CREATE LEVEL category WITH ATTRIBUTES{
		i_category: Text DATASOURCE i_category
	} WITH ID: i_category AND DESCRIPTION: i_category,
	CREATE LEVEL All_item WITH ATTRIBUTES{
		All: Text DATASOURCE All
	} WITH ID: All AND DESCRIPTION: All	
}
HIERARCHY item>product_name>category>All_item
DATASOURCE item;

CREATE CUBE store_sales_cube 
DATASOURCE store_sales
MEASURES quantity AT store_sales.ss_quantity, 
		 wholesale_cost AT store_sales.ss_wholesale_cost
REFERENCES DIMENSION customer_dim AT store_sales.ss_customer_sk,
					 customer_address_dim AT store_sales.ss_addr_sk,
					 date_dim AT store_sales.ss_sold_date_sk,
					 time_dim AT store_sales.ss_sold_time_sk,
					 store_dim AT store_sales.ss_store_sk,
					 item_dim AT store_sales.ss_item_sk;